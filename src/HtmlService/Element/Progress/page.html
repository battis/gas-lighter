<html>
  <head>
    <?!= include('style', data) ?>
  </head>
  <body>
    <div id="content">Loadingâ€¦</div>
    <?!= include('lib', data) ?>
    <script>
      const thread = '<?!= data.thread ?>';
      function updateProgress() {
        google.script.run
          .withSuccessHandler((progress) => {
            if (progress.complete) {
              google.script.host.close();
            } else {
              replaceContent(progress.html);
              updateProgress();
            }
          })
          .getProgress(thread);
      }
      updateProgress();
    </script>
  </body>
</html>
