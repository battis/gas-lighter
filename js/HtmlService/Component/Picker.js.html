<script>((g)=>{var lib;(()=>{"use strict";var t={488:(t,e,i)=>{i.r(e),i.d(e,{default:()=>o});const o='<form id="confirmation"> <div><% actionName %>: <% option %></div> <div><% confirmation %></div> <div class="form-group bottom-right"> <button id="cancel" type="cancel" class="btn btn-secondary">Cancel</button> <button id="confirm" type="submit" class="btn btn-danger"> <% confirm %> </button> </div> </form> '},292:(t,e,i)=>{i.r(e),i.d(e,{default:()=>o});const o='<form id="picker"> <div class="form-group"> <label for="picker"><% message %></label> <div class="input-group"> <select id="options" name="picker" class="custom-select"> <% options %> </select> <div class="input-group-append"> <button class="btn btn-primary" type="submit"><% actionName %></button> </div> </div> </div> </form> '},667:(t,e,i)=>{i.r(e),i.d(e,{default:()=>o});const o='<option value="<% value %>"><% name %></option> '},73:(t,e,i)=>{i.r(e),i.d(e,{default:()=>o});const o='<div> <strong>Error:</strong> <code>data.picker.callback</code> is not defined. </div> <button id="cancel" class="btn btn-secondary">Cancel</button> '},870:function(t,e,i){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(i(0));class a{static displayConfirmation(){g.HtmlService.Component.replaceContent(n.default.confirmation({actionName:this.picker.actionName,option:this.option.name,confirmation:this.picker.confirmation,confirm:this.picker.confirm})),document.getElementById("confirmation").addEventListener("submit",(t=>{t.preventDefault(),g.HtmlService.Component.loading(),google.script.run[this.picker.callback](this.option.value,this.job)})),document.getElementById("cancel").addEventListener("click",(()=>{google.script.host.close()}))}static handleSubmit(t){t.preventDefault();const e=document.getElementById("options");return this.option={value:e.value,name:document.querySelector(`#options option[value="${e.value}"]`).innerText},this.picker.confirmation.length?this.displayConfirmation():(g.HtmlService.Component.loading(),google.script.run[this.picker.callback](this.option.value,this.job)),!1}static displayPicker(t){this.picker.callback.length?(g.HtmlService.Component.replaceContent(n.default.form({message:this.picker.message,options:t,actionName:this.picker.actionName})),document.getElementById("picker").addEventListener("submit",this.handleSubmit)):(g.HtmlService.Component.replaceContent(n.default.pickerCallbackUndefined),document.getElementById("#cancel").addEventListener("click",(()=>google.script.host.close())))}static init(){g.HtmlService.Component.loading(),google.script.run.withSuccessHandler(this.displayPicker)[this.picker.list]()}}e.default=a,a.job="<?!= data.job ?>",a.picker={message:"<?!= data.picker.message ?>",list:"<?!= data.picker.list ?>",actionName:"<?!= data.picker.actionName ?>",callback:"<?!= data.picker.callback  ?>",confirmation:"<?!= data.picker.confirmation ?>",confirm:"<?!= data.picker.confirm ?>"},a.option={}},0:function(t,e,i){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(i(667)),a=o(i(292)),c=o(i(73)),r=o(i(488));class l{static template(t,e){for(const i in e)t=t.replace(new RegExp(`<% *${i} *%>`,"g"),e[i]);return t}static option({name:t,value:e}){return this.template(n.default,{name:t,value:e.toString()})}static form({message:t,options:e,actionName:i}){return this.template(a.default,{message:t,options:e.map(this.option).join(""),actionName:i})}static confirmation({actionName:t,option:e,confirmation:i,confirm:o}){return this.template(r.default,{actionName:t,option:e,confirmation:i,confirm:o})}}e.default=l,l.pickerCallbackUndefined=c.default}},e={};function i(o){var n=e[o];if(void 0!==n)return n.exports;var a=e[o]={exports:{}};return t[o].call(a.exports,a,a.exports,i),a.exports}i.d=(t,e)=>{for(var o in e)i.o(e,o)&&!i.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var o=i(870);lib=o})();g.HtmlService=g.HtmlService||{};g.HtmlService.Component=g.HtmlService.Component||{};g.HtmlService.Component.Picker=lib;})(window.g=window.g||{})</script>